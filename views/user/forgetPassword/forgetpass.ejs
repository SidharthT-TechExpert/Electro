<link rel="stylesheet" href="/CSS/forgetpass.css">
<%- include('../partials/user/header') %>
  <%- include("../partials/user/messages") %>

    <!-- ================= Reset Password ================= -->
    <div class="reset-container">

      <input type="hidden" id="redirectInput" value="<%= redirect || '' %>">
      <!-- LEFT PANEL -->
      <div class="reset-left">

        <!-- Step 1: Enter Email -->
        <div class="reset-step active" id="step-1">
          <h2>üîê Reset Password</h2>
          <form onsubmit="Reset(this)">
            <p class="subtitle">Enter your <b>Email</b> to continue.</p>
            <input id="identifier" name="email" class="rc-input" type="text" placeholder="Enter your Email " autofocus  autocomplete="off"/>
             <span id="emailError" class="login-error"></span>
            <a href="<%= redirect ? `/logIn?redirect=${encodeURIComponent(redirect)}` : '/logIn' %>">Login?</a>
            <div style="text-align: end;" class="signup-link">
              <a href="<%= redirect ? `/signUp?redirect=${encodeURIComponent(redirect)}` : '/signUp' %>">Sign Up?</a>
            </div>

            <button class="rc-btn" name="submit" type="submit" id="toStep2">Next</button>
          </form>
        </div>

        <!-- Step 2: OTP Verification -->
        <div class="reset-step" id="step-2" aria-hidden="true">
          <h2>üì≤ Verify OTP</h2>
          <p class="subtitle">Enter the <b>6-digit</b> code sent to your email.</p>

          <div class="rc-otp-row" id="otpRow">
            <input maxlength="1" class="rc-otp" inputmode="numeric" />
            <input maxlength="1" class="rc-otp" inputmode="numeric" />
            <input maxlength="1" class="rc-otp" inputmode="numeric" />
            <input maxlength="1" class="rc-otp" inputmode="numeric" />
            <input maxlength="1" class="rc-otp" inputmode="numeric" />
            <input maxlength="1" class="rc-otp" inputmode="numeric" />
          </div>

          <div class="rc-timer-wrap">
            <div class="rc-timer-label" id="timerText">‚è≥ 30s</div>
            <div class="rc-timer-bar">
              <div id="timerFill"></div>
            </div>
          </div>

          <a href="<%= redirect ? `/logIn?redirect=${encodeURIComponent(redirect)}` : '/logIn' %>">Login?</a>
          <div style="text-align: end;" class="signup-link">
            <a href="<%= redirect ? `/signUp?redirect=${encodeURIComponent(redirect)}` : '/signUp' %>">Sign Up?</a>
          </div>

          <p id="otpError" class="rc-error">‚ùå Invalid OTP. Please try again.</p>
          <button class="rc-btn" id="verifyOtpBtn">Verify OTP</button>
          <button class="btn" style="color: rgb(68, 67, 67);background-color: #0f0f0f;" id="resendBtn">Resend
            Code</button>
        </div>

        <!-- Step 3: Reset Password -->
        <div class="reset-step" id="step-3" aria-hidden="true">
          <h2>üîë Create New Password</h2>
          <form action="">
            <p class="subtitle">Choose a strong password for your account.</p>

            <div class="password-wrapper">
              <input id="newPass" class="rc-input" type="password" placeholder="New password" />
              <i class="fa fa-eye toggle-pass" data-target="newPass"></i>
            </div>

            <div class="strength-wrap">
              <div class="strength-bar">
                <div id="strengthMeter"></div>
              </div>
              <div id="strengthLabel" class="strength-label"></div>
            </div>

            <div class="password-wrapper">
              <input id="confirmPass" class="rc-input" type="password" placeholder="Confirm password" />
              <i class="fa fa-eye toggle-pass" data-target="confirmPass"></i>
            </div>

            <a href="<%= redirect ? `/logIn?redirect=${encodeURIComponent(redirect)}` : '/logIn' %>">Login?</a>
            <div style="text-align: end;" class="signup-link">
              <a href="<%= redirect ? `/signUp?redirect=${encodeURIComponent(redirect)}` : '/signUp' %>">Sign Up?</a>
            </div>

            <p id="passError" class="rc-error">‚ùå Passwords do not match.</p>
            <button class="rc-btn" id="resetBtn">Update Password</button>
          </form>
        </div>

      </div>

      <!-- RIGHT PANEL -->
      <div class="reset-right">
        <h3>Reset Your Password!</h3>
        <p><strong>Set a new password to get back into your account</strong>.</p>
        <img src="/img/Banner2.jpg" alt="promo" class="promo-img" />
      </div>
    </div>

    <%- include('../partials/user/footer') %>
      <script src="/js/forgetpass.js"></script>